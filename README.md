# Домашняя работа по DevOps
Хазратова Гузель, группа 11-207
## Содержание

[Задание 1](#задание-1-написание-скрипта)

[Задание 2](#задание-2-написание-playbook)

[Задание 3](#задание-3-написание-dockerfile)

[Задание 4](#задание-4-написание-docker-compose)

## Задание 1. Написание скрипта

### Запуск скрипта
1. Если путь указан:

![1](images/1.png)

2. Если путь не указан - запрашивается:

![2](images/2.png)

### Выполненные задачи:
1. Создание группы dev и добавление несистемных пользователей (основной + несколько созданных user для примера)

![3](images/3.png)

2. Настройка права sudo

![4](images/4.png)

Проверяем как работает на user1:

![5](images/5.png)

3. Создание рабочей директории

![6](images/6.png)

Информация о пользователе

![6.1](images/6.1.png)

Проверяем параметры:

![7](images/7.png)

4.  Вывод:

    a) В консоль (на первом изображении)

    b) В лог файл

![8](images/8.png)


## Задание 2. Написание playbook
### Запуск playbook

![9](images/9.png)

### Выполненные задачи:
1. Подключение по SSH - проходит

![10](images/10.png)

2. Создание пользователя, который находится в группе sudo


![11](images/11.png)

3. У папки .ssh все необходимые права и файл authorized_keys содержит нужный ключ


![12](images/12.png)

4. Установка необходимых параметров SSH в конфиге

![13](images/13.png)

5. Рабочая директория создана с необходимыми правами

![14](images/14.png)

## Задание 3. Написание Dockerfile
Пояснения по работе: Dockerfile создаёт образ на основе Debian, устанавливает nginx и postgres. Конфиг nginx добавлен, потому что он нужен для настройки веб-сервера, а конфиг postgres - нет, так как в данном случае используются стандартные настройки БД и nginx будет работать независимо от postgres. 

Контейнер запускает оба сервиса, а также монтирует том для хранения данных БД.

HTML-страничка index.html добавляется в образ для отображения простой веб-страницы при обращении к контейнеру.

### Сборка образа 
![15](images/15.png)
### Cлои image и их размер на диске
![16](images/16.png)
### Запуск контейнера
![17](images/17.png)
![18](images/18.png)
### Проверка доступности nginx
![19](images/19.png)

## Задание 4. Написание Docker Compose

Пояснения по работе: Docker Compose файл разворачивает два сервиса: веб-сервер nginx на порту 8080 и базу данных postgresql, соединенные через пользовательскую сеть custom_bridge с фиксированными IP-адресами.

Nginx настроен через конфигурационный файл для вывода тестового сообщения, а PostgreSQL использует именованный том для хранения данных и имеет заданные переменные окружения.

### Запуск контейнеров
![20](images/20.png)

### Проверяем, что оба контейнера запустились
![21](images/21.png)

### Проверка доступности nginx
![22](images/22.png)

### Проверка соединения между контейнерами
![23](images/23.png)

![24](images/24.png)

### Подробная информация о volume
![25](images/25.png)